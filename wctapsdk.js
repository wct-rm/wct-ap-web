class WCTAPSDK{static #a;constructor(){if(WCTAPSDK.#a)throw Error("WCTAPSDK is a singleton. Use getInstance() to access the instance.");this.visitorIdCookie="wctVisitorId",this.customerIdCookie="wctCustomerId"}static getInstance(){return WCTAPSDK.#a||(WCTAPSDK.#a=new WCTAPSDK),WCTAPSDK.#a}generateWctVisitorId(){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return Array.from({length:22},()=>t.charAt(Math.floor(Math.random()*t.length))).join("")}ensureWctVisitorId(){let t=this.getCookie(this.visitorIdCookie);t||(t=this.generateWctVisitorId(),this.setCookie(this.visitorIdCookie,t,730))}setCookie(t,e,r){let i=new Date;i.setTime(i.getTime()+864e5*r),document.cookie=`${t}=${e};expires=${i.toUTCString()};path=/`}getCookie(t){let e=`${t}=`,r=document.cookie.split(";");for(let i of r){let o=i.trim();if(o.startsWith(e))return o.substring(e.length)}return null}getBrowserContext(){return{browser_context:{pv_id:encodeURIComponent(this.getCookie(this.visitorIdCookie)),rpv_id:encodeURIComponent(this.getCookie(this.visitorIdCookie)),ts:Date.now(),u:window.location.href}}}isMobileUser(){return/android|iphone|ipad|ipod|blackberry|windows phone|mobile/i.test(navigator.userAgent||navigator.vendor||window.opera)}getUniversalParams(){let t={tenantId:encodeURIComponent(this.tenantId),visitorId:encodeURIComponent(this.getCookie(this.visitorIdCookie)),version:"1.0.0",platform:this.isMobileUser()?"mobile":"desktop"},e=this.getCookie(this.customerIdCookie);return e&&e.length>0&&(t.customerId=encodeURIComponent(e)),t}updateQueryParam(t,e,r){let i=new URL(t);return i.searchParams.set(e,r),i.toString()}async makeGetRequest(t){try{let e=await fetch(t,{method:"GET"});if(!e.ok)throw Error(`GET request failed with status ${e.status}`);return e.json()}catch(r){throw console.error("Error during GET request:",r),r}}async makePostRequest(t,e){try{let r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error(`POST request failed with status ${r.status}`);let i=await r.text();return i?r.json():null}catch(o){throw console.error("Error during POST request:",o),o}}static initialize(t){if(!t)throw Error("tenantId is required to initialize the SDK.");let e=WCTAPSDK.getInstance();e.tenantId=t,e.beaconURL="https://sp-beacon-service-pingo.prod.walmart.com",e.orderURL="https://sp-beacon-service-pingo.prod.walmart.com",e.ensureWctVisitorId()}static setCustomerId(t){let e=WCTAPSDK.getInstance();e.setCookie(e.customerIdCookie,t,730)}static clearCustomerId(){let t=WCTAPSDK.getInstance();t.setCookie(t.customerIdCookie,"",-1)}static async trackSponsoredClick(t){if(!t)throw Error("On Click Beacon is required.");try{new URL(t)}catch(e){throw Error("Invalid On Click Beacon URL")}let r=WCTAPSDK.getInstance();var i=r.getUniversalParams();delete i.tenantId;let o=new URLSearchParams({...i,rdf:0}).toString();var s=`${t}${t.includes("?")?"&":"?"}${o}`;return s=r.updateQueryParam(s,"bt",1),r.makeGetRequest(s)}static async trackSponsoredImpression(t,e){if(!t||!e)throw Error("adModuleInfo and impressionBeacons are required for trackSponsoredImpression.");let r=WCTAPSDK.getInstance();if(!r.tenantId||!r.beaconURL)throw Error("SDK not initialized. Call initialize() first.");return r.makePostRequest(`${r.beaconURL}/sp/trk/im`,{impressions:[{adModuleInfo:t,impressionBeacons:e,...r.getUniversalParams(),...r.getBrowserContext()}]})}static async trackSponsoredView(t,e){if(!t||!e)throw Error("adModuleInfo and impressionBeacons are required for trackSponsoredView.");let r=WCTAPSDK.getInstance();if(!r.tenantId||!r.beaconURL)throw Error("SDK not initialized. Call initialize() first.");return r.makePostRequest(`${r.beaconURL}/sp/trk/view`,{views:[{adModuleInfo:t,impressionBeacons:e,...r.getUniversalParams(),...r.getBrowserContext()}]})}static async trackSponsoredNoAd(t){if(!t)throw Error("adModuleInfo is required for trackSponsoredNoAd.");let e=WCTAPSDK.getInstance();if(!e.tenantId||!e.beaconURL)throw Error("SDK not initialized. Call initialize() first.");return e.makePostRequest(`${e.beaconURL}/sp/trk/noad`,{noads:[{adModuleInfo:t,...e.getUniversalParams(),...e.getBrowserContext()}]})}static async trackOrder(t){if(!t)throw Error("order is required for trackOrder.");let e=WCTAPSDK.getInstance();if(!e.tenantId||!e.orderURL)throw Error("SDK not initialized. Call initialize() first.");return e.makePostRequest(`${e.orderURL}/sp/trk/order`,{...t,...e.getUniversalParams(),...e.getBrowserContext()})}}class WCTAPOrder{constructor(t,e,r,i,o,s){this.orderId=t,this.orderTotal=e,this.orderSubtotal=r,this.orderTax=i,this.items=o,this.purchaseTime=s;let n=new Date(s);isNaN(n.getTime())||(this.ds=n.toISOString().split("T")[0],this.hour=n.getHours())}}class WCTAPOrderItem{constructor(t,e,r,i){this.itemId=t,this.quantity=e,this.unitPrice=r,this.totalPrice=i,this.sellerId="0"}}